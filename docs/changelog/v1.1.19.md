# v1.1.19：新增 GitLab Duo 支持与 Ask Question 工具

**发布日期**：2026年1月14日

---

## 一句话总结

这次更新添加了 **GitLab Duo Agentic Chat** 支持，并在桌面应用中集成了"向 Claude 提问"工具。

---

## 新功能：GitLab Duo 支持

### 这次更新了什么？

现在可以使用 GitLab 的 AI 代码助手 GitLab Duo Agentic Chat 了。

### GitLab Duo 是什么？

GitLab Duo 是 GitLab 内置的 AI 代码助手，提供：
- 代码补全和生成
- 代码解释和重构建议
- 安全漏洞检测
- 自然语言查询代码库

### 什么时候用 GitLab Duo？

| 你的开发环境 | 推荐模型 |
|-------------|----------|
| 主要用 GitLab，公司有 Duo 订阅 | ✅ GitLab Duo |
| 个人项目，用 GitHub | GPT-5.2 / Codex |
| 企业内网，用 GitLab 自托管 | ✅ GitLab Duo |

### 如何使用？

👉 **连接 GitLab Duo**：

1. 输入 `/connect`
2. 选择 **GitLab Duo**
3. 配置你的 GitLab 访问令牌
4. 开始使用！

> 💡 **提示**：需要你的 GitLab 实例启用了 GitLab Duo 功能。

---

## 新功能：桌面应用"向 Claude 提问"工具

### 这次更新了什么？

桌面应用现在支持"向 Claude 提问"工具，让你在开发过程中随时向 Claude 寻求帮助。

### 对你有什么好处？

之前这个工具只能在 TUI 中使用，现在桌面用户也可以享受这个功能了。

### 如何使用？

在桌面应用中：

1. 开始一个任务
2. Claude 会自动识别需要向你提问的场景
3. 在对话框中输入你的答案
4. 继续对话

> 💡 **用途**：当 Claude 需要确认你的偏好、选择或决策时，会使用这个工具。

---

## 问题修复：资源泄漏

### 之前的问题

长时间使用 MCP（Model Context Protocol）服务器时，可能出现资源泄漏，占用过多内存。

### 现在的情况

修复了两个内存泄漏问题：
- 关闭旧的 MCP 客户端后再创建新的
- 实例销毁时删除 recordsByKey 中的键

现在可以长期稳定使用 MCP 服务器了。

---

## 要不要升级？

| 情况 | 建议 |
|------|------|
| 用 GitLab | ✅ 升级（支持 GitLab Duo）|
| 用桌面应用 | ✅ 升级（新增 Ask Question 工具）|
| 长时间使用 MCP 服务器 | ✅ 升级（修复内存泄漏）|
| 不符合以上情况 | 可以等下次 |

**升级命令**：

```bash
opencode upgrade
```

---

## 技术细节（可跳过）

<details>
<summary>点击展开完整更新列表</summary>

### Core（核心）

- 防止代理使用无自定义的问题
- 改进探索代理的提示词
- 为提供商测试添加插件模拟
- 更新 webfetch 中的 User-Agent 字符串到最新 Chrome 版本
- 添加带进入和退出工具的计划模式
- 为 Codex 插件中的 GPT 5.2 Codex 添加 family 属性
- 添加 GitLab Duo Agentic Chat 提供商支持
- 实例销毁时从 recordsByKey 删除键
- 在重新分配前关闭现有 MCP 客户端以防止资源泄漏
- 为桌面应用添加 Ask Question 工具支持

### TUI（终端界面）

- 调整 TUI 中的外部目录权限渲染
- 确保 TUI 中外部目录和 Bash 工具调用渲染工作目录详情
- 修复 MCP 认证 CLI 界面中的重复单选按钮图标

### Desktop（桌面应用）

- 在 IME 检查之前处理 Shift+Enter 以防止提示输入卡住
- 在桌面应用的选择模型对话框中恢复供应商图标

### 社区贡献

- @dbpolito：桌面应用 Ask Question 工具支持
- @cmdr-chara：添加 Undertale 和 Deltarune 内置主题
- @vglafirov：GitLab Duo 支持
- @sauerdaniel：修复 MCP 资源泄漏
- 以及其他 4 位贡献者

</details>

---

[← 返回更新日志](./index.md)
