# v1.1.20：连接状态可视化与稳定性提升

**发布日期**：2026年1月14日

---

## 一句话总结

这次更新在 `/connect` 对话框中**显示已连接的提供商**，提升了使用体验，并修复了多个稳定性问题。

---

## 新功能：连接状态可视化

### 这次更新了什么？

在 `/connect` 对话框中，现在可以看到哪些提供商已经连接成功，哪些还需要连接。

### 对你有什么好处？

之前：
- 不清楚自己已经连接了哪些提供商
- 可能重复配置已经连接好的服务
- 切换提供商时需要手动记住

现在：
- 清晰看到已连接的提供商
- 一目了然知道哪些还可用
- 更容易管理多个 AI 账户

### 如何使用？

1. 输入 `/connect`
2. 查看列表，已连接的提供商会显示状态
3. 选择需要配置或切换的提供商
4. 完成配置

---

## 问题修复：桌面侧边栏"加载更多"

### 之前的问题

桌面应用侧边栏的"加载更多"按钮在点击后不会正确加载更多内容，需要重复点击。

### 现在的情况

"加载更多"按钮现在能正常工作，一次点击即可加载更多历史记录。

---

## 问题修复：桌面应用密码认证

### 之前的问题

设置了 `OPENCODE_SERVER_PASSWORD` 环境变量后，桌面应用可能无法正常工作。

### 现在的情况

桌面应用现在完全支持服务器密码认证，可以安全地与本地 CLI 服务通信。

> 💡 **密码认证**：用于在桌面应用和 CLI 之间建立安全连接，防止未授权访问。

---

## 问题修复：内存泄漏

### 之前的问题

长时间运行桌面应用可能会出现内存泄漏，占用过多系统资源。

### 现在的情况

修复了 Footer 组件中的超时跟踪问题，防止内存泄漏。现在可以长时间稳定运行。

---

## 其他改进

- **去重文件引用**：发送给 AI 的提示中不再包含重复的文件引用，节省 token
- **计划模式改进**：在非 git worktree 环境下也能正常使用计划模式
- **Codex 会话优化**：跳过 Codex OAuth 会话中的重复系统提示

---

## 要不要升级？

| 情况 | 建议 |
|------|------|
| 使用桌面应用 | ✅ 升级（修复多个问题）|
| 使用多个 AI 提供商 | ✅ 升级（连接状态可视化）|
| 设置了密码认证 | ✅ 升级（桌面应用支持）|
| 只用 TUI，且没发现问题 | 可以等下次 |

**升级命令**：

```bash
opencode upgrade
```

---

## 技术细节（可跳过）

<details>
<summary>点击展开完整更新列表</summary>

### Core（核心）

- 修复桌面侧边栏中的"加载更多"按钮行为
- 修复在非 git worktree 环境下的计划模式
- 跳过 Codex OAuth 会话中的重复系统提示

### TUI（终端界面）

- 修复 Docker 镜像中 SST 重命名后的提示
- 在 /connect 对话框中显示已连接的提供商
- 去重发送提示中的文件引用
- 在 Footer 组件中跟踪所有超时以防止内存泄漏
- 使 TUI 在设置了 OPENCODE_SERVER_PASSWORD 时也能工作

### SDK

- 为 ToolContext 类型添加缺失的 metadata() 和 ask() 定义

### 社区贡献

感谢 21 位社区贡献者的参与，包括：
- @LeonMueller-OneAndOnly：密码认证支持
- @AksharP5：连接状态可视化
- @sauerdaniel：内存泄漏修复
- @felixzsh：文件引用去重
- @goniz：Docker 镜像修复
- 以及其他 16 位贡献者

</details>

---

[← 返回更新日志](./index.md)
